# Give your test a name!
name: ContributorsRecord

# runs weekly - testing for per minute
on:
  schedule:
    - cron:  '*/1 * * * *'
    # minute (0 - 59), hour (0 - 23), day of month (1 - 31), month(1 - 12 or JAN-DEC), day of week (0 - 6 or SUN-SAT)

# Set up the Continuous Integration job
jobs:
  ContributorsRecord:
    runs-on: ubuntu-latest
    # This section collects together the steps involved in running the test
    steps:
      - name: Checkout branch for Pull Requesting to GitHub
        uses: actions/checkout@v2
      - name: Combine contributors.md and contributors table
        run: |
          ./tests/contributors.sh
      - name: Add contributors-record.md to Afterword and commit changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add ./book/website/afterword/contributors-record.md
          git commit -am 'authomated update of Contributors Record'
          git push
      - name: pull-request
        uses: repo-sync/pull-request@v2
        with:
          source_branch: ""                                   # If blank, default: triggered branch
          destination_branch: "master"                        # If blank, default: master
          pr_title: "Update Contributors Record in Afterword" # Title of pull request
          pr_label: "automated-pr,community"
          github_token: ${{ secrets.GITHUB_TOKEN }}
